{% extends "base/back/base_admin.html" %}
{% block title %} Product Manager Page{% endblock title %}
{%load static %}

{% block content%}

    <!-- Content Header (Page header) -->
    <div class="content-header">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-sm-6">
            <h1 class="m-0"> Product Manager Page</h1>
          </div><!-- /.col -->
          <div class="col-sm-6">
            <ol class="breadcrumb float-sm-right">
              <li class="breadcrumb-item"><a href="#">Home</a></li>
              <li class="breadcrumb-item active"> Product Manager Page</li>
            </ol>
          </div><!-- /.col -->
        </div><!-- /.row -->
      </div><!-- /.container-fluid -->
    </div>

	<div class="row">
		<div class="col-lg-3 col-6">
		<!-- small box -->
			<div class="small-box bg-info">
				<div class="inner">
				<h3>150</h3>

				<p>จำนวนรายการสินค้าทั้งหมด <small>(Total Unique Products)</small></p>
				</div>
				<div class="icon">
				<i class="ion ion-bag"></i>
				</div>
				<a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
			</div>
		</div>
		<!-- ./col -->
		<div class="col-lg-3 col-6">
		<!-- small box -->
		<div class="small-box bg-success">
			<div class="inner">
			<h3>53<sup style="font-size: 20px">%</sup></h3>

			<p>มูลค่ารวมของสต็อกสินค้า<small> (Total Stock Value)</small></p>
			</div>
			<div class="icon">
			<i class="ion ion-stats-bars"></i>
			</div>
			<a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
		</div>
		</div>
		<!-- ./col -->
		<div class="col-lg-3 col-6">
		<!-- small box -->
		<div class="small-box bg-warning">
			<div class="inner">
				<h3>44</h3>

				<p>จำนวนสินค้าคงเหลือรวม <small>(Total Stock Quantity) </small></p>
			</div>
			<div class="icon">
				<i class="ion ion-person-add"></i>
			</div>
			<a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
		</div>
		</div>
		<!-- ./col -->
		<div class="col-lg-3 col-6">
		<!-- small box -->
		<div class="small-box bg-danger">
			<div class="inner">
				<h3>65</h3>

				<p>จำนวนสินค้าที่ขาด/ใกล้หมด<small> (Low Stock/Out of Stock Items) </small></p>
			</div>
			<div class="icon">
				<i class="ion ion-pie-graph"></i>
			</div>
			<a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
		</div>
		</div>
		<!-- ./col -->
    </div>
	<!-- Graph Report-->
	<div class="row">
		<div class="col-md-8">
		<div class="card">
			<div class="card-header">
			<h5 class="card-title">Monthly Recap Report</h5>

			<div class="card-tools">
				<button type="button" class="btn btn-tool" data-card-widget="collapse">
				<i class="fas fa-minus"></i>
				</button>
				<div class="btn-group">
				<button type="button" class="btn btn-tool dropdown-toggle" data-toggle="dropdown">
					<i class="fas fa-wrench"></i>
				</button>
				<div class="dropdown-menu dropdown-menu-right" role="menu">
					<a href="#" class="dropdown-item">Action</a>
					<a href="#" class="dropdown-item">Another action</a>
					<a href="#" class="dropdown-item">Something else here</a>
					<a class="dropdown-divider"></a>
					<a href="#" class="dropdown-item">Separated link</a>
				</div>
				</div>
				<button type="button" class="btn btn-tool" data-card-widget="remove">
					<i class="fas fa-times"></i>
				</button>
			</div>
			</div>
			<!-- /.card-header -->
			<div class="card-body">
			<div class="row">
				<div class="col-md-8">
				<p class="text-center">
					<strong>Sales: 1 Jan, 2014 - 30 Jul, 2014</strong>
				</p>

				<div class="chart">
					<!-- Sales Chart Canvas -->
					<canvas id="salesChart" height="180" style="height: 180px;"></canvas>
				</div>
				<!-- /.chart-responsive -->

				</div>
				<!-- /.col -->
				<div class="col-md-4">
				<p class="text-center">
					<strong>Goal Completion</strong>
				</p>

				<div class="progress-group">
					Add Products to Cart
					<span class="float-right"><b>160</b>/200</span>
					<div class="progress progress-sm">
					<div class="progress-bar bg-primary" style="width: 80%"></div>
					</div>
				</div>
				<!-- /.progress-group -->

				<div class="progress-group">
					Complete Purchase
					<span class="float-right"><b>310</b>/400</span>
					<div class="progress progress-sm">
					<div class="progress-bar bg-danger" style="width: 75%"></div>
					</div>
				</div>

				<!-- /.progress-group -->
				<div class="progress-group">
					<span class="progress-text">Visit Premium Page</span>
					<span class="float-right"><b>480</b>/800</span>
					<div class="progress progress-sm">
					<div class="progress-bar bg-success" style="width: 60%"></div>
					</div>
				</div>

				<!-- /.progress-group -->
				<div class="progress-group">
					Send Inquiries
					<span class="float-right"><b>250</b>/500</span>
					<div class="progress progress-sm">
					<div class="progress-bar bg-warning" style="width: 50%"></div>
					</div>
				</div>
				<!-- /.progress-group -->
				</div>
				<!-- /.col -->
			</div>
			<!-- /.row -->
			</div>
			<!-- ./card-body -->
			<div class="card-footer">
				<div class="row">
					<div class="col-sm-3 col-6">
					<div class="description-block border-right">
						<span class="description-percentage text-success"><i class="fas fa-caret-up"></i> 17%</span>
						<h5 class="description-header">$35,210.43</h5>
						<span class="description-text">TOTAL REVENUE</span>
					</div>
					<!-- /.description-block -->
					</div>
					<!-- /.col -->
					<div class="col-sm-3 col-6">
					<div class="description-block border-right">
						<span class="description-percentage text-warning"><i class="fas fa-caret-left"></i> 0%</span>
						<h5 class="description-header">$10,390.90</h5>
						<span class="description-text">TOTAL COST</span>
					</div>
					<!-- /.description-block -->
					</div>
					<!-- /.col -->
					<div class="col-sm-3 col-6">
					<div class="description-block border-right">
						<span class="description-percentage text-success"><i class="fas fa-caret-up"></i> 20%</span>
						<h5 class="description-header">$24,813.53</h5>
						<span class="description-text">TOTAL PROFIT</span>
					</div>
					<!-- /.description-block -->
					</div>
					<!-- /.col -->
					<div class="col-sm-3 col-6">
					<div class="description-block">
						<span class="description-percentage text-danger"><i class="fas fa-caret-down"></i> 18%</span>
						<h5 class="description-header">1200</h5>
						<span class="description-text">GOAL COMPLETIONS</span>
					</div>
					<!-- /.description-block -->
					</div>
				</div>
			<!-- /.row -->
			</div>
			<!-- /.card-footer -->
		</div>
		<!-- /.card -->
		</div>
		<div class="col-md-4">
			<div class="card">
              <div class="card-header">
                <h3 class="card-title">Browser Usage</h3>

                <div class="card-tools">
                  <button type="button" class="btn btn-tool" data-card-widget="collapse">
                    <i class="fas fa-minus"></i>
                  </button>
                  <button type="button" class="btn btn-tool" data-card-widget="remove">
                    <i class="fas fa-times"></i>
                  </button>
                </div>
              </div>
              <!-- /.card-header -->
              <div class="card-body">
                <div class="row">
                  <div class="col-md-8">
                    <div class="chart-responsive"><div class="chartjs-size-monitor"><div class="chartjs-size-monitor-expand"><div class=""></div></div><div class="chartjs-size-monitor-shrink"><div class=""></div></div></div>
                      <canvas id="pieChart" height="161" width="323" style="display: block; width: 323px; height: 161px;" class="chartjs-render-monitor"></canvas>
                    </div>
                    <!-- ./chart-responsive -->
                  </div>
                  <!-- /.col -->
                  <div class="col-md-4">
                    <ul class="chart-legend clearfix">
                      <li><i class="far fa-circle text-danger"></i> Chrome</li>
                      <li><i class="far fa-circle text-success"></i> IE</li>
                      <li><i class="far fa-circle text-warning"></i> FireFox</li>
                      <li><i class="far fa-circle text-info"></i> Safari</li>
                      <li><i class="far fa-circle text-primary"></i> Opera</li>
                      <li><i class="far fa-circle text-secondary"></i> Navigator</li>
                    </ul>
                  </div>
                  <!-- /.col -->
                </div>
                <!-- /.row -->
              </div>
              <!-- /.card-body -->
              <div class="card-footer p-0">
                <ul class="nav nav-pills flex-column">
                  <li class="nav-item">
                    <a href="#" class="nav-link">
                      United States of America
                      <span class="float-right text-danger">
                        <i class="fas fa-arrow-down text-sm"></i>
                        12%</span>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="#" class="nav-link">
                      India
                      <span class="float-right text-success">
                        <i class="fas fa-arrow-up text-sm"></i> 4%
                      </span>
                    </a>
                  </li>
				                    <li class="nav-item">
                    <a href="#" class="nav-link">
                      India
                      <span class="float-right text-success">
                        <i class="fas fa-arrow-up text-sm"></i> 4%
                      </span>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="#" class="nav-link">
                      China
                      <span class="float-right text-warning">
                        <i class="fas fa-arrow-left text-sm"></i> 0%
                      </span>
                    </a>
                  </li>
                </ul>
              </div>
              <!-- /.footer -->
            </div>
		</div>

		<!-- /.col -->
    </div>
	<!-- Table Report-->
	<div class="row">
		<div class="col-12">
			<div class="card">
				<div class="card-header">
					<h3 class="card-title">ตารางรายงานสินค้า</h3>
					<div class="card-tools">
						<ul class="nav nav-pills ml-auto">
						<li class="nav-item">
							<a class="nav-link active" href="{% url 'create-product' %}" > <i class="fa fa-plus-circle" aria-hidden="true"></i> เพิ่มสินค้าใหม่</a>
						</li>
						</ul>
					</div>
				</div>
				<!-- /.card-header -->
				<div class="card-body">
					<table id="example1" class="table table-bordered table-striped">
						<thead>					
							<tr>
								<th> SKU </th>
								<th > ชื่อสินค้า </th>
								<th > หมวดหมู่ </th>
								<th > สต็อกปัจจุบัน </th>
								<th > สต็อกขั้นต่ำ </th>
								<th > สถานะ </th>
								<th class="project-actions text-right"> จัดการ </th>
							</tr>
						</thead>
						<tbody>
							{% for product in products %}
							
								<tr>
									<td> {{ product.id }} </td>
									<td>								
										
										<a href="#" data-toggle="modal" data-target="#modal-view{{product.id}}">
											{%if product.image_product %}
											<img src="{{ product.image_product.url }}" class="rounded" alt="{{ product.name }}" width="30" height="30"> &nbsp; {{ product.name }} &nbsp;
											{% else %}
											<i class="bi bi-image-fill"></i> &nbsp; {{ product.name }}
											{% endif %}
										</a>

									</td>
									<td>{{ product.price }}</td>
									<td>{{ product.cost }}</td>
									<td>{{ product.stock_quantity }} {{ product.unit }} </td>
									<td> 
										<i class="bi bi-exclamation-diamond-fill" style="color:green;"></i>
									</td>
									
									<td class="project-actions text-right">
										<a href="{% url 'view-product' product.pk %}" class="btn btn-info"><i class="fas fa-eye"></i></a>
										<a href="{% url 'delete-product' product.pk %}" type='button' class="btn btn-danger"  data-toggle="modal" data-target="#modal-delete{{product.id}}" ><i class="fas fa-trash"></i></a>
									</td>
								</tr>

								<div class="modal fade" id="modal-delete{{ product.id }}">
									<div class="modal-dialog">
										<div class="modal-content">
										<div class="modal-header">
											<h5>คุณต้องการลบข้อมูล ?</h5>
											<button type="button" class="close" data-dismiss="modal" aria-label="Close">
											<span aria-hidden="true">×</span>
											</button>
										</div>
										<div class="modal-body">
											<p> <code>ชื่อสินค้า :</code>  <b> {{product.name }} </b> </p>		
								
										</div>
										<div class="modal-footer justify-content-between">
											<a href="{% url 'delete-product' product.id %}" type="button" class="btn btn-danger"> <i class="bi bi-trash"></i> ยืนยันลบข้อมูล</a>
											<button type="button" class="btn btn-outline-light" data-dismiss="modal">Close</button>
											
										</div>
										</div>
										<!-- /.modal-content -->
									</div>
									<!-- /.modal-dialog -->
								</div>

								<div class="modal fade show" id="modal-view{{ product.id}}" >
									<div class="modal-dialog modal-xl">
										<div class="modal-content">
											<div class="modal-header">
											<h4 class="modal-title">รายละเอียดสินค้า</h4>
											<button type="button" class="close" data-dismiss="modal" aria-label="Close">
												<span aria-hidden="true">×</span>
											</button>
											</div>
											<div class="modal-body">
												<div class="row invoice-header">
													<div class="col-sm-12">
														<div class="card card-primary card-outline">
															<div class="card-body box-profile">
															{% if product.image_product %}
															<div class="text-center">
																 <img src="{{ product.image_product.url }}" alt="{{ product.name }}" class="rounded" width="250px" height="250px">
															</div>
															{% else %}
															<div class="text-center">
																<img class="profile-user-img img-fluid img-circle" src="{% static 'media/product_images/image_product.jpg' %}" alt="User profile picture">
															</div>
															{% endif %}

															<h3 class="profile-username text-center">{{ product.name }}</h3>

															<p class="text-muted text-center">{{ product.category}}</p>

															<ul class="list-group list-group-unbordered mb-3">
																<li class="list-group-item">
																<b>จำนวนที่ขายไปแล้ว</b> <a class="float-right">1,322</a>
																</li>
																<li class="list-group-item">
																<b>จำนวนสต๊อกสินค้า</b> <a class="float-right">543</a>
																</li>
																<li class="list-group-item">
																<b>กำไรรวม</b> <a class="float-right">13,287</a>
																</li>
															</ul>

															<a href="#" class="btn btn-primary btn-block"><b>แก้ใขข้อมูลสินค้า</b></a>
															</div>
															<!-- /.card-body -->
														</div>
														<!-- /.card -->
													</div>
													<!-- /.col -->
												</div>
												<!-- Main content -->
												<div class="row invoice-info">
													<div class="col-lg-4 invoice-col">
														<address>
															<strong>หมวดหมู่: </strong><span class="text-muted float-right">{{ product.category }}<span><br>
															<strong>ชื่อ: </strong><span class="text-muted float-right ">{{ product.name }}</span><br>						
															<strong>รายละเอียด: </strong><p class="text-muted ">{{ product.description| truncatechars:100}}</p>
															<strong>ราคาขาย: </strong><span class="text-muted float-right ">฿ {{ product.price }}</span><br><br>
															<strong>ราคาต้นทุน:</strong><span class="text-muted float-right ">฿ {{ product.cost }}</span><br><br>
															<strong>จำนวนสินค้า:</strong><span class="text-muted float-right ">฿ {{ product.stock_quantity}} {{ product.unit}} </span><br><br>
															<strong>กำไรต่อชิ้น:</strong><span class="text-muted float-right ">฿ {{ product.profit_per_item }} </span><br><br>
															<strong> ผู้จัดทำรายการ </strong><span class="text-muted float-right "></span><br>
															
															<div class="user-block mt-2">																 
																<img class="img-circle img-bordered-sm" src="../../dist/img/user6-128x128.jpg" alt="User Image">
																<span class="username"><a href="#">{{product.created_by}}</a></span>
																<span class="description">Product Manager</span>
															</div>
														</address>
													</div>
													<!-- /.col -->
													<div class="col-lg-4 invoice-col">
													<b>ผู้จัดจำหน่าย</b>
													<br>
													<address>
														<p class="text-muted">{{ product.supplier.name }}</p>

														<b>ผู้ติดต่อ </b>
														<p class="text-muted">{{ product.supplier.contact_person}}</p>

														<b>เบอร์โทรศัพท์</b>
														<p class="text-muted">{{product.supplier.phone_number}}</p>

														<b>Email </b>
														<p class="text-muted">{{ product.supplier.email}}</p>

														<b>ที่อยู่:</b>														
														<p class="text-muted">{{ product.supplier.address}}</p>

														<b>จังหวัด:</b>
														<p class="text-muted">{{ product.supplier.provide}}</p>

														<b>รหัสไปรษณีย์:</b>
														<p class="text-muted">{{ product.supplier.code}}</p>

														<b>ประเทศ:</b>
														<p class="text-muted">{{ product.supplier.email}}</p>	
														<b>เว็บไซต์:</b>
														<p class="text-muted">{{ product.supplier.website}}</p>
														<b>หมายเหตุ:</b>
														<p class="text-muted">{{ product.supplier.note}}</p>	
													</address>
													</div>
													<!-- /.col -->
													<div class="col-lg-4 invoice-col">
													<b>รหัสสินค้า</b> {{ product.barcode }}<br>
													<br>
													<b>Order ID:</b> 4F3S8J<br>
													<b>จัดส่งเมื่อ:</b> {{ product.update }}<br>
													<b>วันหมดอายุ:</b> {{ product.expiry_date }}<br>
													<b>สถานะการจัดส่ง:</b>
													{% if product.is_delivered %}
														<span class="text-success">จัดส่งแล้ว</span>
													{% else %}
														<span class="text-danger">ยังไม่จัดส่ง</span>
													{% endif %}	
													<br>
													<b>สถานะการชำระเงิน:</b>
													{% if product.is_paid %}
														<span class="text-success">ชำระเงินแล้ว</span>
													{% else %}
														<span class="text-danger">ยังไม่ชำระเงิน</span>
													{% endif %}
													<br>
													<b>สถานะ:</b> 
													{% if product.stock_alert > product.stock_quantity %}
														<span class="text-danger">สินค้าค้าใกล้จะหมดสต๊อก</span>
													{% else %}
														<span class="text-success">สินค้าสต๊อกปกติ </span>
													{% endif %}
													<br>

													</div>
													<!-- /.col -->
												</div>
												<!-- /.row -->
											</div>
										</div>
									<!-- /.modal-content -->
									</div>
									<!-- /.modal-dialog -->
								</div>


							{% endfor %}
						</tbody>
					</table>
				</div>
				<!-- /.card-body -->
			</div>
			<!-- /.card -->
		</div>
		<!-- /.col -->
	</div>


{% endblock content%}